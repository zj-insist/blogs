# React Nativeå…¥é—¨æ€»ç»“

æœ€è¿‘ä¸‰å‘¨ï¼Œä»é›¶å¼€å§‹å­¦ä¹ å½“å‰è¾ƒä¸ºç«çƒ­çš„React NativeæŠ€æœ¯ï¼Œä½¿ç”¨RNåœ¨iOSå¹³å°å®Œæˆä¸€äº›å°Demoå’Œä¸€ä¸ªé™æ€çš„å•†å“è¯¦æƒ…é¡µã€‚æ•´ä½“æ¥è¯´ï¼Œå¯¹äºä¸€ä¸ªæ²¡æœ‰ä»»ä½•å‰ç«¯å¼€å‘ç»éªŒçš„Nativeç¨‹åºå‘˜æ¥ï¼ŒRNçš„å­¦ä¹ æ›²çº¿è¿˜æ˜¯ç›¸å½“é™¡å³­çš„ã€‚ä¸ä»…è¦æ¥è§¦å­¦ä¹ RNæ¡†æ¶ï¼Œè¿˜è¦æŒæ¡JSçš„è¯­è¨€ç‰¹æ€§å’Œç›¸å…³æœºåˆ¶ï¼Œè€ŒJSçš„ç¼–ç¨‹ä¹ æƒ¯å’Œä¸€äº›è§„èŒƒï¼Œå’Œæ­¤å‰ç†è§£çš„OOç¼–ç¨‹æ€æƒ³è¿˜æ˜¯æœ‰ç›¸å½“å¤§å·®å¼‚ã€‚æ­¤å¤–ï¼Œä¸€é¡¹æ–°å…´çš„æŠ€æœ¯ï¼Œå…¶ç›¸å…³çš„å‚è€ƒèµ„æ–™å’Œæ¡ˆä¾‹éƒ½æ˜¯å¾ˆå°‘çš„ã€‚å†åŠ ä¸ŠRNçš„ç‰ˆæœ¬ä¹Ÿåœ¨å¿«é€Ÿçš„è¿­ä»£ä¸­ï¼Œå¯èƒ½ä»…ä»…ä¸‰ä¸ªæœˆå‰çš„Demoï¼Œåœ¨å½“å‰ç‰ˆæœ¬å°±å·²ç»ä¸èƒ½è¿è¡Œã€‚å› æ­¤ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸­è¿˜æ˜¯è¸©äº†ç›¸å½“å¤šçš„å‘ã€‚å½“ç„¶ï¼Œè¸©å¾—å‘å¤šäº†ï¼Œè¿˜æ˜¯æœ‰äº›æ”¶è·çš„ã€‚æ•´ä½“çš„å…¥é—¨çº¿è·¯åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š   
1. ä»€ä¹ˆæ˜¯React Native
2. iOSå¹³å°ä¸‹ï¼ŒReact Nativeæ˜¯å¦‚ä½•å·¥ä½œçš„
3. å­¦ä¹ JavaScript ES6æ ‡å‡†
4. æ­å»ºå¼€å‘ç¯å¢ƒä»¥åŠé‡åˆ°çš„ç¯å¢ƒä¸­çš„ä¸€äº›å‘
5. IDEå·¥ä½œç¯å¢ƒé…ç½®ä»¥åŠDeBugå·¥å…·ä½¿ç”¨
6. ä½¿ç”¨RNæ„å»ºDemoçš„ä¸€äº›ä½“ä¼š

## **1.å…³äºReact Native**

é¦–å…ˆè¦äº†è§£ä»€ä¹ˆæ˜¯React Nativeï¼Œä»¥ä¸‹æ˜¯å®˜æ–¹çš„ä»‹ç»ï¼š
>React Native enables you to build world-class application experiences on native platforms using a consistent developer experience based on JavaScript and React. The focus of React Native is on developer efficiency across all the platforms you care about - learn once, write anywhere. Facebook uses React Native in multiple production apps and will continue investing in React Native.  

æ ¹æ®å®˜æ–¹ä»‹ç»ï¼ŒReact Nativeçš„æ ¸å¿ƒåŒæ ·æ˜¯åŸºäºReactæ¡†æ¶ï¼Œå¹¶é’ˆå¯¹Nativeå¹³å°åšäº†ç›¸åº”çš„é€‚é…å’Œå°è£…å·¥ä½œã€‚é‚£ä»€ä¹ˆåˆæ˜¯Reactå‘¢ï¼Ÿå®ƒåŒæ ·æ˜¯FacebookåŸºäºJavascriptå¼€å‘çš„ä¸€ä¸ªå‰ç«¯æ¡†æ¶ï¼Œä¸åŒäºä¼ ç»Ÿçš„MVCæ¶æ„ï¼Œå“åº”å¼çš„æœºåˆ¶ä½¿å®ƒå¯ä»¥æ›´æ•ˆç‡çš„ä¿éšœå¤§å‹é¡¹ç›®ä¸­æ•°æ®åœ¨æ¨¡å‹å’Œè§†å›¾ä¹‹é—´çš„æµåŠ¨ã€‚ä¼ ç»Ÿçš„Javascriptåº”ç”¨ï¼Œæˆ–è€…è¯´ï¼Œä¼ ç»Ÿçš„MVCæ¶æ„ä¸­ï¼Œé™¤äº†ç•Œé¢æ„å»ºã€ä¸šåŠ¡é€»è¾‘ã€æ•°æ®å¤„ç†ä¹‹å¤–ï¼Œè¿˜éœ€è¦ç»´æŠ¤å¤§é‡ä»£ç ä¿éšœæ¨¡å‹æ•°æ®å’ŒUIæ˜¾ç¤ºçš„ä¸€è‡´ã€‚è€Œåœ¨Reactä¸­ï¼Œåˆ™ä½¿ç”¨ä¸€ç§ä¸åŒçš„æ–¹æ¡ˆï¼š

>å½“ç»„ä»¶ç¬¬ä¸€æ¬¡åˆå§‹åŒ–æ—¶ï¼Œ`render`æ–¹æ³•è¢«è°ƒç”¨ï¼Œä¸ºè§†å›¾ç”Ÿæˆä¸€ä¸ªè½»é‡çº§çš„è¡¨ç°ã€‚é€šè¿‡è¿™ä¸ªè¡¨ç°ï¼Œäº§ç”Ÿä¸€ä¸ªæ ‡ç­¾å­—ç¬¦ä¸²ï¼Œç„¶åæ’å…¥åˆ°æ–‡æ¡£ä¸­ã€‚å½“æ•°æ®å˜åŒ–æ—¶ï¼Œ`render`æ–¹æ³•å†æ¬¡è¢«è°ƒç”¨ã€‚ä¸ºäº†å°½å¯èƒ½æœ‰æ•ˆçš„å®Œæˆæ›´æ–°ï¼Œæˆ‘ä»¬æ¯”è¾ƒä¹‹å‰è°ƒç”¨`render`è¿”å›çš„å€¼ä¸æ–°çš„å€¼ï¼Œç„¶åäº§ç”Ÿä¸€ä¸ªæœ€å°é™åº¦çš„å˜æ›´å»åº”ç”¨åˆ°DOMä¸­ã€‚`render`è¿”å›çš„æ•°æ®æ—¢ä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ä¹Ÿä¸æ˜¯ä¸€ä¸ªDOMç»“ç‚¹ã€‚å®ƒæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ç±»å‹ï¼Œæè¿°DOMåº”è¯¥æ˜¯ä»€ä¹ˆæ ·çš„ã€‚

å¯ä»¥çœ‹åˆ°ï¼ŒReactä¸­é‡‡å–ä¸€ç§é»˜è®¤çš„ç»‘å®šæœºåˆ¶ï¼Œåœ¨æ•°æ®æ¨¡å‹æ”¹å˜æ—¶ä¼šè‡ªåŠ¨çš„å”¤èµ·ç•Œé¢çš„æ›´æ–°ï¼Œç”±æ­¤ä¿éšœæ•°æ®ä¸€è‡´ã€‚è¿™å’ŒiOSå¼€å‘ä¸­æœ€è¿‘å‡ å¹´å¼€å§‹ç«çƒ­çš„MVVMæ¶æ„ç›¸å½“ç±»ä¼¼ï¼Œä½¿ç”¨ä¸€å±‚ViewModelé“¾æ¥Viewå’ŒModelï¼Œå®ç°æ•°æ®å’ŒUIæ˜¾ç¤ºçš„ç»‘å®šçš„æ•ˆæœâ€”â€”å½“æ˜¾ç¤ºç•Œé¢æœ‰äº‹ä»¶ä¼ é€’æ—¶ï¼ŒViewModelå¯ä»¥æ›´æ–°Modelï¼›åå‘çš„ï¼Œå½“æ•°æ®åœ¨åå°å˜æ¢åï¼ŒåŒæ ·å¯ä»¥é€šè¿‡ViewModelé€šçŸ¥UIæ˜¾ç¤ºç•Œé¢æ›´æ–°ã€‚  

å¦‚æœä»…ä»…æ˜¯å¼•å…¥ä¸€ç§å“åº”å¼çš„ç¼–ç¨‹æ–¹å¼ï¼ŒRNæ¨è¡Œçš„è§£å†³æ–¹æ¡ˆå¹¶æ²¡æœ‰å¸å¼•åŠ›ï¼Œå®ƒæœ€å¸å¼•äººçš„åœ¨äºé›†æˆ Web App å’Œ Native App çš„ä¼˜ç‚¹ï¼ŒæŠ›å¼ƒç¼ºç‚¹ã€‚ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š  

#### 1.å¼€å‘æˆæœ¬  

Nativeç«¯çš„å¼€å‘æˆæœ¬æ˜¯ä¸€ä¸ªä¸€ç›´è¢«è¯Ÿç—…çš„é—®é¢˜ã€‚ç†è®ºæ¥è¯´ï¼Œå¸‚é¢ä¸Šæœ‰å¤šå°‘åœ¨è¿è¡Œçš„å¹³å°ï¼Œå°±éœ€è¦å‡ ä¸ªä¸ä¹‹å¯¹åº”çš„Native Appã€‚ä¸€å¥—ç›¸åŒçš„æµç¨‹ï¼Œè¿›è¡Œå¤šæ¬¡å¼€å‘ï¼Œæ€ä¹ˆçœ‹éƒ½æ˜¯ä¸€ç§æµªè´¹ã€‚
![](./Images/0-0.jpg)  

æ”¾ä¸€å¼ ä»‹ç» React å’Œ RN çš„å›¾ï¼Œå¯ä»¥çœ‹åˆ°RNç»§æ‰¿Web Appçš„ä¼˜åŠ¿ï¼Œåªéœ€è¦ä¸€æ¡æŠ€æœ¯çº¿çš„å­¦ä¹ ï¼Œä¾¿å¯ä»¥å¼€å‘å…¼å®¹å¤šç«¯çš„åº”ç”¨ï¼Œè¿™ä¹Ÿå’ŒFacebookå®˜æ–¹å®£ç§°çš„`"learn once, write anywhere"`çš„æ€æƒ³ç›¸å½“å»åˆã€‚åœ¨RNåœ¨ç»„ä»¶å’ŒAPIè®¾è®¡ä¸Šï¼Œä¹Ÿåšåˆ°å°½é‡åŒæ—¶å…¼å®¹å¤šä¸ªå¹³å°ï¼Œä»å½“å‰çš„æ›´æ–°è¶‹åŠ¿çœ‹ï¼Œä¸åŒå¹³å°çš„ç»„ä»¶å’ŒAPIå·®å¼‚éƒ½å°†è¢«æ…¢æ…¢æŠ¹å»ï¼Œæœ€ç»ˆå½¢æˆä¸€ä¸ªç»Ÿä¸€çš„å¹³å°ï¼Œè€Œä¸å†éœ€è¦å»å…³æ³¨åº•å±‚çš„åŸç”Ÿå¹³å°æ˜¯ä»€ä¹ˆã€‚

#### 2.ç”¨æˆ·ä½“éªŒä»¥åŠæ€§èƒ½  

Web Appæ›¾ç»å› ä¸ºå¼€å‘æˆæœ¬ç›¸å¯¹ä½ï¼Œå¯ä»¥åŠ¨æ€æ›´æ–°ç«è¿‡ä¸€æ®µæ—¶é—´ï¼Œä¹‹åå´åˆå› ä¸ºï¼ŒåŠ è½½é€Ÿåº¦ç¼“æ…¢ï¼Œç”¨æˆ·äº¤äº’ä½“éªŒä¸å¤Ÿè‰¯å¥½ï¼Œè¿‡å¤šå ç”¨æ€§èƒ½ç­‰é—®é¢˜å†·è½ä¸‹æ¥ã€‚RNåŒæ ·æ˜¯ä½¿ç”¨JSè¿™ç§åŠ¨æ€è¯­è¨€å®ç°æ•´ä¸ªé¡µé¢çš„æ„å»ºï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œå®ƒå´æ˜¯å®å®åœ¨åœ¨çš„åŸç”Ÿåº”ç”¨ï¼Œåœ¨JSä»£ç ä¸­çš„å„ä¸ªæ ‡ç­¾ï¼Œéƒ½ä¼šè½¬åŒ–ä¸ºNativeçš„UIç»„ä»¶ã€‚  
![RNApp](./Images/RNApp.png  "RNApp")   
![WebApp](./Images/WebApp.png "WebApp")

ä»¥ä¸Šä¸¤å¼ å›¾åˆ†åˆ«æ˜¯RNAppå’ŒWebAppçš„ä¸€ä¸ªç®€å•çš„Demoå±•ç¤ºï¼Œä¸ºäº†æ›´å¥½åœ°å¯¹æ¯”ï¼Œå°½é‡ä¿è¯ä¸¤ä¸ªDemoå†…å®¹çš„ç»Ÿä¸€ã€‚å…ˆä¸è°ˆäº¤äº’ï¼Œè¿™ä¸¤ä¸ªç•Œé¢éƒ½æ˜¯åœ¨ç”¨æˆ·å±‚é¢çš„å±•ç¤ºå†…å®¹ï¼Œé™¤æ‰webViewçš„åŠ è½½è¿›åº¦æ¡ï¼ŒåŸºæœ¬æ˜¯æ¯«æ— åŒºåˆ«çš„ã€‚ä¹‹åï¼Œå…ˆçœ‹ä¸€ä¸‹RNAppçš„View Treeå’Œwindowsçš„å±•ç¤ºï¼š  
![RNView](./Images/RNView.png  "RNView")   
![RNWindows](./Images/RNWindows.png "RNWindows")  
å¯ä»¥çœ‹åˆ°ï¼ŒRNAppç¡®å®ä¸å®£ç§°çš„`çœŸæ­£çš„åŸç”Ÿ`æ˜¯ä¸€è‡´çš„ã€‚åœ¨ç•Œé¢æ„å»ºæ—¶å€™ï¼Œç»„ç»‡å¤šå°‘containor viewï¼Œæœ€ç»ˆéƒ½ä¼šæ˜¾ç¤ºåœ¨ç•Œé¢ä¸Šã€‚ä»æ•´ä¸ªwindowsçš„ç»“æ„ä¹Ÿçœ‹åˆ°ï¼Œç•Œé¢çš„ç»„ç»‡éƒ½æ˜¯ä½¿ç”¨çš„RCTå¼€å¤´çš„åŸç”Ÿç»„ä»¶ï¼Œè¿™äº›æ‰æ˜¯åœ¨appä¸­çœŸæ­£å·¥ä½œçš„ç»„ä»¶ï¼Œè€Œä¸åƒwebä¸€æ ·ä½¿ç”¨çš„æ˜¯HTMLå…ƒç´ ã€‚  
ä¹‹åï¼Œæ˜¯WebAppçš„View Treeå’Œwindowsï¼š  
![WebView](./Images/WebView.png  "WebView")   
![WebWindows](./Images/WebWindows.png "WebWindows")  
å¾ˆæ˜æ˜¾çš„å¯¹æ¯”ï¼Œä¸ç®¡WebAppçš„ç•Œé¢ä¸Šå±•ç¤ºå¤šå°‘å…ƒç´ ï¼Œåœ¨View Treeä¸­éƒ½åªæœ‰ä¸€ä¸ªWebViewçš„å®¹å™¨ï¼Œè¿™ç‚¹ä»æ•´ä¸ªwindowsçš„ç»“æ„ä¹Ÿå¯ä»¥çœ‹åˆ°ã€‚  
å…³äºåŠ è½½é€Ÿåº¦ï¼Œå¯èƒ½å¹¶ä¸èƒ½ç»™å‡ºè¯¦å°½çš„æ•°æ®ï¼Œä½†å¯ä»¥æ•´ä½“æ„Ÿè§‰åˆ°RNçš„åŠ è½½é€Ÿåº¦å¹¶æ²¡æœ‰æ¯”åŸç”Ÿæ…¢å¤šå°‘ï¼Œç”šè‡³åŸºäºJSè¿™ç§è„šæœ¬è¯­è¨€çš„ç‰¹æ€§ï¼ŒRNè¿˜å¯ä»¥åšåˆ°åŠ¨æ€æ›´æ–°ï¼Œå½“æˆ‘æ›´æ”¹ä¸€å¤„çš„ä»£ç ï¼Œå¹¶ä¸éœ€è¦é‡æ–°ç¼–è¯‘æ•´ä¸ªAPPï¼Œè€Œåªéœ€è¦åƒåˆ·æ–°ç½‘é¡µä¸€æ ·åˆ·æ–°ä¸€ä¸‹ç•Œé¢ä¾¿å¯çœ‹åˆ°è¿™äº›æ›´æ”¹ã€‚ç„¶åè¯´è¯´ç”¨æˆ·ä½“éªŒï¼Œå¯èƒ½ç»è¿‡ä¸€ç³»åˆ—çš„ä¼˜åŒ–ï¼ŒWebViewçš„äº¤äº’ä½“éªŒå·²ç»å¯ä»¥ä¸è¾“åŸç”Ÿã€‚ç„¶è€Œï¼ŒRNAppä¸­ï¼ŒçœŸæ­£æ„å»ºAppçš„è¿˜æ˜¯åŸç”Ÿç»„ä»¶ï¼Œå¯ä»¥è¯´ï¼Œæ•´ä¸ªRNçš„äº¤äº’ä½“éªŒï¼Œåº”è¯¥æ˜¯å’ŒåŸç”Ÿåº”ç”¨ä¸€è‡´çš„ã€‚

#### 3.åŠ¨æ€UIå’Œçƒ­æ›´æ–°

Nativeåº”ç”¨çš„å¾ˆå¤§ä¸€é¡¹é—®é¢˜ä¾¿æ˜¯æ¯æ¬¡æ›´æ–°éƒ½éœ€è¦é‡æ–°å‘åŒ…ï¼Œåœ¨iOSå¹³å°ç”šè‡³éœ€è¦é‡æ–°è¿›è¡Œå®¡æ ¸ï¼Œæ‰€ä»¥å¾ˆå¤šAppçš„æ´»åŠ¨é¡µé¢éƒ½æ˜¯ä½¿ç”¨webæ„å»ºä¿éšœå¯ä»¥åœ¨åå°è¿›è¡ŒåŠ¨æ€çš„é…ç½®UIç•Œé¢ã€‚è€Œä½¿ç”¨RNè¿™ç§æŠ€æœ¯ï¼Œç”±äºJSå¤©ç„¶åŠ¨æ€æ€§ï¼Œå¯ä»¥éšæ—¶ä¸‹å‘æ•°æ®å’Œä»£ç ï¼Œéšæ—¶å®šåˆ¶UIï¼Œç›¸å¯¹äºWebåˆ¶ä½œçš„é¡µé¢ï¼ŒRNæ‹¥æœ‰æ›´ä½³çš„æ€§èƒ½ã€‚å…³äºçƒ­æ›´æ–°ï¼ŒiOSä¸­ç”¨çš„è¾ƒå¤šçš„æ˜¯JSPatchï¼Œéƒ½æ˜¯ç”¨æ¥çƒ­ä¿®å¤çº¿ä¸Šçš„ä¸€éƒ¨åˆ†Bugï¼Œè€Œå¾ˆå°‘ç”¨æ¥å»æ–°å¢ä¸šåŠ¡åŠŸèƒ½ï¼Œè€Œå…¶ä»–çš„çƒ­æ›´æ–°æ–¹æ¡ˆéƒ½ç›¸å½“å¤æ‚ï¼Œæœ‰çš„ç”šè‡³éœ€è¦é‡å¯Appæ‰ç”Ÿæ•ˆã€‚ä½†æ˜¯ä½¿ç”¨JSè¯­è¨€å°±ä¸ä¸€æ ·ï¼ŒåŠ¨æ€è¯­è¨€çš„ä¸€å¤§å¥½å¤„å°±æ˜¯å¯ä»¥éšæ—¶æ‰§è¡Œï¼Œéšæ—¶æ›¿æ¢ï¼Œä½¿ç”¨RNä¹‹åï¼Œå°±å¯ä»¥åšåˆ°éšæ—¶è¿è¡Œæ›´æ–°JSä»£ç ï¼Œå®ç°èµ·æ¥æ¯”åŸç”Ÿçš„æ–¹æ¡ˆç®€å•å¾ˆå¤šã€‚  
  
ç®€å•çš„è¯´ï¼ŒRNä¾¿æ˜¯ç§»åŠ¨ç«¯çš„Reactã€‚ä½¿ç”¨JSè¿™ç§åŠ¨æ€è¯­è¨€æ„å»ºNativeåº”ç”¨ï¼ŒåŒæ—¶ï¼Œè„±ç¦»iOSå¹³å°ä¸Šä¼ ç»Ÿçš„MVCæ¶æ„ï¼Œå¼•å…¥Reactçš„MVVMç¼–ç¨‹æ€æƒ³ï¼Œé›†æˆNativeå’ŒWebåº”ç”¨çš„ä¼˜ç‚¹ï¼Œé™ä½å¼€å‘æˆæœ¬ã€‚

## **2.React Nativeå·¥ä½œåŸç†**

å…³äºå¼€å‘ç¯å¢ƒçš„æ­å»ºå’Œå„ç§é…ç½®ï¼Œç½‘ä¸Šæœ‰å¾ˆå¤šç›¸åº”çš„èµ„æºï¼Œåœ¨æ­¤ä¸åšä»‹ç»ã€‚è¿™ç« ä¸»è¦ä»‹ç»ä¸€ä¸‹RNé¡¹ç›®å’ŒNativeé¡¹ç›®çš„ä¸åŒï¼Œä»¥åŠRNæ¡†æ¶åœ¨iOSå¹³å°æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚  
é¦–å…ˆä½¿ç”¨`react-native init`å‘½ä»¤åˆ›å»ºä¸€ä¸ªRNé¡¹ç›®ï¼Œä¹‹åä»iosæ–‡ä»¶å¤¹ä¸­çš„xcodeé¡¹ç›®æ–‡ä»¶æ‰“å¼€å·¥ç¨‹ã€‚æ•´ä¸ªé¡¹ç›®å’Œä»xcodeä¸­åˆ›å»ºçš„é¡¹ç›®ç›¸æ¯”ï¼Œå°‘äº†Main.storyboardï¼Œå¤šå‡ºå¾ˆå¤šRCTå¼€å¤´çš„libraryï¼Œè€Œè¿™äº›librariesä¾¿æ˜¯RNæ¡†æ¶å·¥ä½œçš„åŸºç¡€ï¼Œå…¶ä¸­Reactå®ŒæˆOCå’ŒJSçš„é€šä¿¡ã€‚  
![](./Images/libraries.png)  

æ‰“å¼€Appçš„å…¥å£æ–‡ä»¶AppDelegate.mï¼Œçœ‹åˆ°å…¥å£æ–‡ä»¶åªå‰©ä¸€ä¸ªç¨‹åºå¯åŠ¨å®Œæˆçš„æ–¹æ³•ï¼š

``` objectivec
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
  NSURL *jsCodeLocation;

  jsCodeLocation = [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@"index.ios" fallbackResource:nil];

  RCTRootView *rootView = [[RCTRootView alloc] initWithBundleURL:jsCodeLocation
                                                      moduleName:@"Communication"
                                               initialProperties:nil
                                                   launchOptions:launchOptions];
  rootView.backgroundColor = [[UIColor alloc] initWithRed:1.0f green:1.0f blue:1.0f alpha:1];

  self.window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];
  UIViewController *rootViewController = [UIViewController new];
  rootViewController.view = rootView;
  self.window.rootViewController = rootViewController;
  [self.window makeKeyAndVisible];
  return YES;
}
```
ä¸Nativeä¸ç”¨çš„æ˜¯ï¼Œå¤šå‡ºå‡ ä¸ªRCTå¼€å¤´çš„ç±»å’Œå…¶ç›¸å…³æ–¹æ³•ã€‚é¦–å…ˆï¼Œä»JSç«¯è·å–iOSçš„å…¥å£æ–‡ä»¶åœ°å€ï¼Œä¹‹ååˆ›å»ºä¸€ä¸ª`RCTRootView`ä½œä¸ºæ•´ä¸ªåº”ç”¨çš„æ ¹è§†å›¾ï¼Œåˆ›å»ºè¿™ä¸ªæ ¹è§†å›¾éœ€è¦å‡ ä¸ªç›¸å…³å‚æ•°ï¼Œä¸€ä¸ªæ˜¯å…¥å£æ–‡ä»¶åœ°å€`BundleURL`ï¼Œä¸€ä¸ªæ˜¯åˆå§‹åŠ è½½çš„æ¨¡å—åç§°`moduleName`,ä¹‹åæ˜¯éœ€è¦ä¼ é€’çš„å‚æ•°ï¼Œæœ€åæ˜¯åº”ç”¨å¯åŠ¨æ—¶çš„ä¸€äº›å‚æ•°ã€‚`moduleName`åº”è¯¥æ˜¯å¯¹åº”JSæ–‡ä»¶ä¸­çš„å¯åŠ¨æ¨¡å—ï¼š  
``` JavaScript
AppRegistry.registerComponent('Communication', () => Communication);
```  
ä¹‹åè®¾ç½®windowçš„æ ¹è§†å›¾ï¼Œæ˜¾ç¤ºåŒå¸¸è§„çš„å¯åŠ¨æµç¨‹ã€‚  

å› æ­¤ï¼Œæ•´ä¸ªAppçš„è¿è¡Œç¯å¢ƒåº”è¯¥æ˜¯åœ¨`initWithBundleURL:moduleName:initialProperties:launchOptions:`çš„æ—¶å€™ä¾¿å·²ç»åˆå§‹åŒ–å®Œæˆã€‚æ ¹æ®è°ƒç”¨å †æ ˆï¼Œåœ¨åˆå§‹åŒ–rootViewä¹‹å‰ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ªbridgeï¼š
``` objectivec
  RCTBridge *bridge = [[RCTBridge alloc] initWithBundleURL:bundleURL
                                            moduleProvider:nil
                                             launchOptions:launchOptions];
```  

ç„¶åè¿›å…¥rootViewçš„initå‡½æ•°ï¼Œçœ‹åˆ°è¿™ä¸ªbridgeä½œä¸ºä¸¤ä¸ªé€šçŸ¥çš„ç›‘å¬å¯¹è±¡ï¼Œå®ƒæ˜¯OCå’ŒJSä¹‹é—´çš„æ¡¥æ¢ï¼Œæ•´ä¸ªåº”ç”¨çš„äº¤äº’éƒ½æ˜¯ä¾èµ–è¿™ä¸ªå¯¹è±¡ã€‚ç»§ç»­è¿½è¸ªbridgeçš„åˆå§‹åŒ–æµç¨‹ï¼Œå‘ç°åœ¨`setup`ä¸­åˆ›å»ºä¸€ä¸ªBatchedBridgeå¯¹è±¡ï¼Œå¹¶æ‰§è¡Œè¿™ä¸ªå¯¹è±¡çš„startæ–¹æ³•ã€‚åœ¨è¿™ä¸ªstartå‡½æ•°ä¸­ï¼Œæœ‰æ¸…æ™°çš„å®˜æ–¹æ³¨é‡Šå‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªå‡½æ•°åšäº†å“ªäº›å·¥ä½œï¼ŒåŒ…æ‹¬ä»¥ä¸‹5ä»¶äº‹æƒ…ï¼š
1. åŠ è½½èµ„æºä»£ç 
2. åˆå§‹åŒ–ç»„ä»¶æ¨¡å—
3. åˆå§‹åŒ–JavaScriptExecutor
4. ç”Ÿæˆæ¨¡å—çš„é…ç½®ä¿¡æ¯
5. æ‰§è¡ŒJavaScriptæºç 

#### 1.åŠ è½½èµ„æº

é™¤äº†ä¸€äº›é…ç½®ä¿¡æ¯å’Œé˜Ÿåˆ—çš„åˆ›å»ºï¼Œç¬¬ä¸€ä»¶äº‹ä¾¿æ˜¯åŠ è½½èµ„æºï¼š
```objectivec
  // Asynchronously load source code
  [self loadSource:^(NSError *error, NSData *source, __unused int64_t sourceLength) {
    if (error) {
      RCTLogWarn(@"Failed to load source: %@", error);
      dispatch_async(dispatch_get_main_queue(), ^{
        [weakSelf stopLoadingWithError:error];
      });
    }
```
æ³¨é‡Šå¾ˆæ¸…æ™°æ˜“æ‡‚ï¼Œè¿™é‡ŒåŠ è½½çš„æ˜¯èµ„æºä»£ç ï¼Œé‚£åˆ°åº•æ˜¯ä»€ä¹ˆèµ„æºä»£ç å‘¢ï¼ŸåŒ…å«å“ªäº›å†…å®¹å‘¢ï¼Ÿæˆ‘ä»¬è®¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼Œç„¶åçœ‹ä¸€ä¸‹æ˜¾ç¤ºï¼š
![sourceCode](./Images/sourceCode.png)  
å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ª1.2Mçš„æ–‡ä»¶ï¼Œå…·ä½“å†…å®¹å¥½åƒåŒ…å«å¾ˆå¤šç›¸å…³ä»£ç ï¼Œçœ‹èµ·æ¥å¾ˆåƒJSï¼Œä½†æ˜¯è¿™ä¹ˆä¸ªæ ¼å¼çœ‹è‚¯å®šåè¡€å•Šã€‚é‚£ä¹ˆï¼Œè¿™æ—¶å€™å°±å¯ä»¥å€ŸåŠ©å¼€æºçš„åŠ›é‡ï¼Œæ”¹ä¸€ä¸‹startå‡½æ•°çš„ä»£ç ï¼ŒæŠŠè¿™ä¸ªDataä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå› ä¸ºçœ‹ç€ä»£ç å¾ˆåƒJSï¼Œæˆ‘æ”¹äº†JSåç¼€ï¼Œé…åˆIDEçš„ç€è‰²èƒ½æ›´æ¸…æ™°çš„åˆ†æï¼Œå†…å®¹å¦‚ä¸‹ï¼š  
![dataImage](./Images/dataImage.png)  
å†…å®¹ä¹Ÿä¸å¤šï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ª1.2Mçš„JSä»£ç æ–‡ä»¶ï¼Œ6Wå¤šè¡Œè€Œå·²ğŸ˜‚  
çœ‹æ¥RNæ¡†æ¶å¸®æˆ‘ä»¬ç”Ÿæˆä¸å°‘ä»£ç ï¼Œé‚£è¿™äº›ä»£ç åˆ°åº•å’Œæˆ‘ä»¬å†™çš„JSä»£ç æœ‰å¤šå°‘å…³ç³»å‘¢ï¼Ÿæµ‹è¯•çš„å·¥ç¨‹æ˜¯ä»¥å‰å†™è¿‡çš„ä¸€ä¸ªå­¦ä¹ JSè°ƒç”¨Nativeæ–¹æ³•å’Œç»„ä»¶çš„Demoï¼Œæ‰¾å‡ºä¸€æ®µJSç«¯çš„ä»£ç ï¼š
``` JavaScript
import TestView from './TestView'
var QSNativeModuleExample = NativeModules.QSNativeModuleExample;

export default class Communication extends Component {
  componentDidMount() {
    QSNativeModuleExample.testPrint("Jack", {
      height: '1.78m',
      weight: '7kg'
    });
  }
    render() {
    return (
      <View style={styles.container}>
        <View style={{backgroundColor:'#B9FF61'}}>
          <Text style={styles.welcome}>
            Welcome to React Native!
        </Text>
        </View>
        <View style={{backgroundColor:'#FFD854'}}>
          <Text style={styles.instructions}>
            To get started, edit index.ios.js
        </Text>
        </View>
        <View style={{backgroundColor:'#FF4FA2'}}>
          <Text style={styles.instructions}>
            Press Cmd+R to reload,{'\n'}
            Cmd+D or shake for dev menu
        </Text>
        </View>
      </View>
    );
  }
}
```
ç„¶åå†ç”Ÿæˆçš„æ–‡ä»¶ä¸­æœç´¢`QS`ï¼Œæ˜¾ç¤ºå¦‚ä¸‹ï¼š  
![QS](./Images/QS.png )  
åªæœ‰è¿™å‡ åè¡Œæ˜¯æˆ‘åœ¨å·¥ç¨‹ä¸­çš„ç¼–ç ï¼Œå‰©ä¸‹çš„å¤§è‡´çœ‹äº†ä¸€ä¸‹ï¼Œåº”è¯¥æ˜¯æ ¹æ®importçš„å†…å®¹å°†å¯¹åº”çš„åº“å†™è¿›æ–‡ä»¶ã€‚

#### 2.åˆå§‹åŒ–ç»„ä»¶æ¨¡å—

æ²¡æœ‰å¤ªå¤šå€¼å¾—å…³æ³¨çš„å†…å®¹ï¼Œæƒ³è¦è‡ªå®šä¹‰çš„åŸç”Ÿç»„ä»¶ä¸JSäº¤äº’éœ€è¦ç”¨`RCT_EXPORT_MODULE`å®æ ‡è®°ç»„ä»¶ï¼Œå¹¶å®šä¹‰ä¸€ä¸ªç»„ä»¶åœ¨JSä¸­çš„ç±»åï¼Œå®˜æ–¹å®šä¹‰çš„ç»„ä»¶åŒæ ·æ˜¯ä»¥è¿™ä¸ªå®æ ‡è®°ï¼ŒæŸ¥çœ‹è¿™ä¸ªå®å®šä¹‰ï¼š  
```objectivec
#define RCT_EXPORT_MODULE(js_name) \
RCT_EXTERN void RCTRegisterModule(Class); \
+ (NSString *)moduleName { return @#js_name; } \
+ (void)load { RCTRegisterModule(self); }

void RCTRegisterModule(Class moduleClass)
{
  static dispatch_once_t onceToken;
  dispatch_once(&onceToken, ^{
    RCTModuleClasses = [NSMutableArray new];
  });

  RCTAssert([moduleClass conformsToProtocol:@protocol(RCTBridgeModule)],
            @"%@ does not conform to the RCTBridgeModule protocol",
            moduleClass);

  // Register module
  [RCTModuleClasses addObject:moduleClass];
}
```

è¿™ä¸ªå®è¿”å›åŸç”Ÿçš„ç»„ä»¶åœ¨JSä¸­çš„åå­—ï¼Œç„¶ååœ¨loadæ–¹æ³•ä¸­è°ƒç”¨æ³¨å†Œæ–¹æ³•ï¼ŒæŠŠè¿™ä¸ªç±»åŠ å…¥RCTModuleClassesï¼Œä¹‹åçš„äº‹æƒ…å°±æ˜¯ç”¨ä¸€ä¸ªforå¾ªç¯éå†RCTModuleClassesï¼Œå°†å…¶ä¸­çš„æ‰€æœ‰ç±»éƒ½åŠ å…¥é…ç½®ä¿¡æ¯ï¼š  

```objectivec
for (Class moduleClass in RCTGetModuleClasses()) {
    NSString *moduleName = RCTBridgeModuleNameForClass(moduleClass);

    RCTModuleData *moduleData = moduleDataByName[moduleName];
    moduleData = [[RCTModuleData alloc] initWithModuleClass:moduleClass
                                                     bridge:self];
    moduleDataByName[moduleName] = moduleData;
    [moduleClassesByID addObject:moduleClass];
    [moduleDataByID addObject:moduleData];

    _moduleDataByID = [moduleDataByID copy];
    _moduleDataByName = [moduleDataByName copy];
    _moduleClassesByID = [moduleClassesByID copy];
  }
```
ä»¥ä¸Šçœå»éƒ¨åˆ†æ¡ä»¶åˆ¤æ–­ä»£ç ï¼Œä½†æ•´ä½“çš„ç®¡ç†æ¨¡å—é…ç½®è¡¨çš„é€»è¾‘å¯ä»¥çœ‹åˆ°ï¼Œä¾¿æ˜¯åœ¨Bridgeä¸­ä¿å­˜3ä¸ªæ•°ç»„ï¼Œåˆ†åˆ«å­˜å‚¨DataID,DataNameå’ŒClassID,